# yamdb_final
![yamdb_final workflow](https://github.com/vafansjev/yamdb_final/actions/workflows/yamdb_workflow.yml/badge.svg)

___
## Описание:
Проект YaMDb собирает отзывы пользователей на произведения. Произведения делятся на категории: «Книги», «Фильмы», «Музыка». Список категорий может быть расширен администратором.
___
## Стек технологий:
- Python 3.7.8
- Django 2.2
- DjangoRestFramework 3.12
- SimpleJWT 5.1
- Docker
___
## Как запустить проект:
**Важно!** Перед запуском проекта требуется установить Docker!
Дистрибутив и документация доступны на официальном сайте - https://www.docker.com/products/docker-desktop

После установки Docker приступить к запуску проекта:

Клонировать репозиторий проекта командой
```
git clone <адрес проекта на GitHub>
```

и перейти в директорию с проектом в командной строке
```
cd yamdb_final/infra/
```

В директории infra создать файл .env и наполнить содержимым:
```
DB_ENGINE=django.db.backends.postgresql # указываем, что работаем с postgresql
DB_NAME= # имя базы данных
POSTGRES_USER= # логин для подключения к базе данных
POSTGRES_PASSWORD= # пароль для подключения к БД (установите свой)
DB_HOST=db # название сервиса (контейнера)
DB_PORT= # порт для подключения к БД
```

Не меняя дирректорию выполнить команду:
```
docker-compose up -d
```

В процессе развертывания будут автоматически выполнены команды:
```
python manage.py migrate --noinput
python manage.py collectstatic --no-input
gunicorn api_yamdb.wsgi:application --bind 0:8000
```

Создать суперпользователя (при необходимости):
```
docker-compose exec web python manage.py createsuperuser
```
Загрузить тестовые данные (при необходимости):
```
docker-compose exec web python manage.py loaddata fixtures.json
```
Для остановки работы проекта выполнить команду:
```
docker-compose down -v
```
___
## Описание функционала проекта
### Пользовательские роли в системе:
- Аноним — может просматривать описания произведений, читать отзывы и комментарии.
- Аутентифицированный пользователь (user) — может читать всё, как и Аноним, может публиковать отзывы и ставить оценки произведениям (фильмам/книгам/песенкам), может комментировать отзывы; может редактировать и удалять свои отзывы и комментарии, редактировать свои оценки произведений. Эта роль присваивается по умолчанию каждому новому пользователю.
- Модератор (moderator) — те же права, что и у Аутентифицированного пользователя, плюс право удалять и редактировать любые отзывы и комментарии.
- Администратор (admin) — полные права на управление всем контентом проекта. Может создавать и удалять произведения, категории и жанры. Может назначать роли пользователям.
- Суперюзер Django должен всегда обладать правами администратора, пользователя с правами admin. Даже если изменить пользовательскую роль суперюзера — это не лишит его прав администратора. Суперюзер — всегда администратор, но администратор — не обязательно суперюзер.

### Ресурсы API YaMDb
- Ресурс auth: аутентификация.
- Ресурс users: пользователи.
- Ресурс titles: произведения, к которым пишут отзывы (определённый фильм, книга или песенка).
- Ресурс categories: категории (типы) произведений («Фильмы», «Книги», «Музыка»).
- Ресурс genres: жанры произведений. Одно произведение может быть привязано к нескольким жанрам.
- Ресурс reviews: отзывы на произведения. Отзыв привязан к определённому произведению.
- Ресурс comments: комментарии к отзывам. Комментарий привязан к определённому отзыву.
- Каждый ресурс описан в документации: указаны эндпоинты (адреса, по которым можно сделать запрос), разрешённые типы запросов, права доступа и дополнительные параметры, если это необходимо.


___
### Примеры запросов
Получение токена для авторизации:
```
http://127.0.0.1:8000/api/v1/auth/token/
```
Пример запроса:
```
{
    "username": "string",
    "confirmation_code": "string" 
}
```
Пример ответа:
```
{
    "token": "string"
}
```

Получение списка комментариев к отзыву:
```
http://127.0.0.1:8000/api/v1/titles/{title_id}/reviews/{review_id}/comments/
```
Пример ответа:
```
[
  {
    "count": 0,
    "next": "string",
    "previous": "string",
    "results": [
      {
        "id": 0,
        "text": "string",
        "author": "string",
        "pub_date": "2019-08-24T14:15:22Z"
      }
    ]
  }
]
```


Полный список доступных методов работы с данными доступен после запуска сервера по адресу:
```
http://127.0.0.1:8000/redoc/
```
***

